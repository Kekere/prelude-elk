primitive(inCompetent,1).
primitive(competent,1).
primitive(clientProgram,2).
primitive(vulExists,3).
primitive(vulProperty,3).
primitive(hacl,4).
primitive(attackerLocated,1).
primitive(hasAccount,3).
primitive(networkServiceInfo,5).
primitive(setuidProgramInfo,3).
primitive(nfsExportInfo,4).
primitive(nfsMounted,5).
primitive(localFileProtection,4).
primitive(dependsOn,3).
primitive(installed,2).
primitive(bugHyp,4).
primitive(vulExists,5).
primitive(canAccessFile,4).
primitive(isWebServer,1).
primitive(hasCredentialsOnMemory,2).
primitive(isAdmin,1).
primitive(ipv6Able,1).
primitive(isActive,2).
primitive(awsUserProperty,2).
primitive(hasAccessKeyOnMemory,2).
derived(execCode,2).
derived(netAccess,3).
derived(canAccessHost,1).
derived(accessFile,3).
derived(accessMaliciousInput,3).
derived(principalCompromised,1).
derived(dos,1).
derived(logInService,3).
derived(harvestCredentials,2).
derived(logOn,2).
derived(obtainControl,2).
derived(modify,2).
derived(physicalDamage,1).
derived(stealAwsAccessKey,4).
derived(awsUserCompromise,2).
meta(cvss,2).
meta(attackGoal,1).
meta(advances,2).

attack(execCode('10.0.11.100',user)).

possible_duplicate_trace_step(because(15,rule_desc('direct network access',1.0),netAccess('10.0.11.100',tcp,8080),[hacl('10.0.20.66','10.0.11.100',tcp,8080),attackerLocated('10.0.20.66')])).

possible_duplicate_trace_step(because(16,rule_desc('direct on-host access',1.0),netAccess('10.0.20.66',_h4780,_h4781),[attackerLocated('10.0.20.66')])).

possible_duplicate_trace_step(because(2,rule_desc('Bruteforce attack',0.5),principalCompromised('Bob'),[hasAccount('Bob','10.0.11.100',user),netAccess('10.0.11.100',tcp,8080),inCompetent('Bob')])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(21,rule_desc('password sniffing',0.80000000000000004),principalCompromised('Bob'),[execCode('10.0.11.100',user),hasAccount('Bob','10.0.11.100',user)])).

possible_duplicate_trace_step(because(21,rule_desc('password sniffing',0.80000000000000004),principalCompromised('Bob'),[execCode('10.0.11.100',user),hasAccount('Bob','10.0.11.100',user)])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(11,rule_desc('unrestricted upload of file with dangerous type',1.0),execCode('10.0.11.100',user),[principalCompromised('Bob'),hasAccount('Bob','10.0.11.100',user),vulExists('10.0.11.100','CVE-2021-26868',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(2,rule_desc('Bruteforce attack',0.5),principalCompromised('Bob'),[hasAccount('Bob','10.0.11.100',user),netAccess('10.0.11.100',tcp,8080),inCompetent('Bob')])).

possible_duplicate_trace_step(because(17,rule_desc('Access a host through executing code on the machine',1.0),canAccessHost('10.0.11.100'),[execCode('10.0.11.100',user)])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(21,rule_desc('password sniffing',0.80000000000000004),principalCompromised('Bob'),[execCode('10.0.11.100',user),hasAccount('Bob','10.0.11.100',user)])).

possible_duplicate_trace_step(because(21,rule_desc('password sniffing',0.80000000000000004),principalCompromised('Bob'),[execCode('10.0.11.100',user),hasAccount('Bob','10.0.11.100',user)])).

possible_duplicate_trace_step(because(8,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.11.100',user),[canAccessHost('10.0.11.100'),hasAccount('Bob','10.0.11.100',user),principalCompromised('Bob')])).

possible_duplicate_trace_step(because(17,rule_desc('Access a host through executing code on the machine',1.0),canAccessHost('10.0.11.100'),[execCode('10.0.11.100',user)])).

