primitive(inCompetent,1).
primitive(competent,1).
primitive(clientProgram,2).
primitive(vulExists,3).
primitive(vulProperty,3).
primitive(hacl,4).
primitive(attackerLocated,1).
primitive(hasAccount,3).
primitive(networkServiceInfo,5).
primitive(setuidProgramInfo,3).
primitive(nfsExportInfo,4).
primitive(nfsMounted,5).
primitive(localFileProtection,4).
primitive(dependsOn,3).
primitive(installed,2).
primitive(bugHyp,4).
primitive(vulExists,5).
primitive(canAccessFile,4).
primitive(isWebServer,1).
primitive(hasCredentialsOnMemory,2).
primitive(isAdmin,1).
primitive(ipv6Able,1).
primitive(isActive,2).
primitive(awsUserProperty,2).
primitive(hasAccessKeyOnMemory,2).
derived(execCode,2).
derived(netAccess,3).
derived(canAccessHost,1).
derived(accessFile,3).
derived(accessMaliciousInput,3).
derived(principalCompromised,1).
derived(dos,1).
derived(logInService,3).
derived(harvestCredentials,2).
derived(logOn,2).
derived(obtainControl,2).
derived(modify,2).
derived(physicalDamage,1).
derived(stealAwsAccessKey,4).
derived(awsUserCompromise,2).
meta(cvss,2).
meta(attackGoal,1).
meta(advances,2).

attack(execCode('10.0.13.37',lea)).

possible_duplicate_trace_step(because(18,rule_desc('direct network access',1.0),netAccess('10.0.13.151',tcp,3389),[hacl('10.0.13.0','10.0.13.151',tcp,3389),attackerLocated('10.0.13.0')])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.151',user),[netAccess('10.0.13.151',tcp,3389),networkServiceInfo('10.0.13.151',rdp,tcp,3389,user),vulExists('10.0.13.151','CVE-2019-0708',rdp,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.151',user),[netAccess('10.0.13.151',tcp,3389),networkServiceInfo('10.0.13.151',rdp,tcp,3389,user),vulExists('10.0.13.151','CVE-2019-0708',rdp,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.18.100',tcp,8080),[hacl('10.0.13.151','10.0.18.100',tcp,8080),advances('10.0.13.151','10.0.18.100'),execCode('10.0.13.151',user)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.13.32',tcp,22),[hacl('10.0.13.151','10.0.13.32',tcp,22),advances('10.0.13.151','10.0.13.32'),execCode('10.0.13.151',user)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.18.100',lea),[netAccess('10.0.18.100',tcp,8080),networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.18.100',lea),[netAccess('10.0.18.100',tcp,8080),networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.18.100',lea),[netAccess('10.0.18.100',tcp,8080),networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.32',user),[netAccess('10.0.13.32',tcp,22),networkServiceInfo('10.0.13.32',openssh,tcp,22,user),vulExists('10.0.13.32','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.32',user),[netAccess('10.0.13.32',tcp,22),networkServiceInfo('10.0.13.32',openssh,tcp,22,user),vulExists('10.0.13.32','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.32',user),[netAccess('10.0.13.32',tcp,22),networkServiceInfo('10.0.13.32',openssh,tcp,22,user),vulExists('10.0.13.32','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(3,rule_desc('DoS',0.5),dos('10.0.13.32'),[execCode('10.0.13.32',user),execCode('10.0.13.151',user),hacl('10.0.13.151','10.0.13.32',tcp,22)])).

possible_duplicate_trace_step(because(24,rule_desc('password sniffing',0.80000000000000004),principalCompromised(_h4899),[execCode('10.0.18.100',lea),hasAccount(_h4899,'10.0.18.100',lea)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.13.37',tcp,22),[hacl('10.0.18.100','10.0.13.37',tcp,22),advances('10.0.18.100','10.0.13.37'),execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.13.30',tcp,22),[hacl('10.0.13.32','10.0.13.30',tcp,22),advances('10.0.13.32','10.0.13.30'),execCode('10.0.13.32',user)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.37',lea),[netAccess('10.0.13.37',tcp,22),networkServiceInfo('10.0.13.37',openssh,tcp,22,lea),vulExists('10.0.13.37','CVE-2013-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.30',user),[netAccess('10.0.13.30',tcp,22),networkServiceInfo('10.0.13.30',openssh,tcp,22,user),vulExists('10.0.13.30','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.30',user),[netAccess('10.0.13.30',tcp,22),networkServiceInfo('10.0.13.30',openssh,tcp,22,user),vulExists('10.0.13.30','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.30',user),[netAccess('10.0.13.30',tcp,22),networkServiceInfo('10.0.13.30',openssh,tcp,22,user),vulExists('10.0.13.30','CVE-2023-48795',openssh,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(20,rule_desc('Access a host through executing code on the machine',1.0),canAccessHost('10.0.18.100'),[execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(11,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.18.100',lea),[canAccessHost('10.0.18.100'),hasAccount(_h7616,'10.0.18.100',lea),principalCompromised(_h7616)])).

possible_duplicate_trace_step(because(11,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.18.100',lea),[canAccessHost('10.0.18.100'),hasAccount(_h6886,'10.0.18.100',lea),principalCompromised(_h6886)])).

possible_duplicate_trace_step(because(11,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',0.5),execCode('10.0.18.100',lea),[canAccessHost('10.0.18.100'),hasAccount(_h8127,'10.0.18.100',lea),principalCompromised(_h8127)])).

possible_duplicate_trace_step(because(3,rule_desc('DoS',0.5),dos('10.0.13.30'),[execCode('10.0.13.30',user),execCode('10.0.13.32',user),hacl('10.0.13.32','10.0.13.30',tcp,22)])).

possible_duplicate_trace_step(because(20,rule_desc('Access a host through executing code on the machine',1.0),canAccessHost('10.0.18.100'),[execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.18.100',tcp,8080),[hacl('10.0.13.30','10.0.18.100',tcp,8080),advances('10.0.13.30','10.0.18.100'),execCode('10.0.13.30',user)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.13.37',tcp,22),[hacl('10.0.18.100','10.0.13.37',tcp,22),advances('10.0.18.100','10.0.13.37'),execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(24,rule_desc('password sniffing',0.80000000000000004),principalCompromised(_h4899),[execCode('10.0.18.100',lea),hasAccount(_h4899,'10.0.18.100',lea)])).

possible_duplicate_trace_step(because(4,rule_desc('Keylogger',0.5),logOn('10.0.18.100',lea),[hasAccount(_h8083,'10.0.18.100',lea),dos('10.0.13.30'),hacl('10.0.13.30','10.0.18.100',tcp,8080)])).

possible_duplicate_trace_step(because(4,rule_desc('Keylogger',0.5),logOn('10.0.18.100',lea),[hasAccount(_h7572,'10.0.18.100',lea),dos('10.0.13.30'),hacl('10.0.13.30','10.0.18.100',tcp,8080)])).

possible_duplicate_trace_step(because(4,rule_desc('Keylogger',0.5),logOn('10.0.18.100',lea),[hasAccount(_h5564,'10.0.18.100',lea),dos('10.0.13.30'),hacl('10.0.13.30','10.0.18.100',tcp,8080)])).

possible_duplicate_trace_step(because(5,rule_desc('Keylogger',0.5),execCode('10.0.18.100',lea),[networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation),logOn('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(5,rule_desc('Keylogger',0.5),execCode('10.0.18.100',lea),[networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation),logOn('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(5,rule_desc('Keylogger',0.5),execCode('10.0.18.100',lea),[networkServiceInfo('10.0.18.100',scadabr,tcp,8080,lea),vulExists('10.0.18.100','CVE-2021-26828',scadabr,remoteExploit,privEscalation),logOn('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(24,rule_desc('password sniffing',0.80000000000000004),principalCompromised(_h4899),[execCode('10.0.18.100',lea),hasAccount(_h4899,'10.0.18.100',lea)])).

possible_duplicate_trace_step(because(20,rule_desc('Access a host through executing code on the machine',1.0),canAccessHost('10.0.18.100'),[execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(17,rule_desc('multi-hop access',0.5),netAccess('10.0.13.37',tcp,22),[hacl('10.0.18.100','10.0.13.37',tcp,22),advances('10.0.18.100','10.0.13.37'),execCode('10.0.18.100',lea)])).

possible_duplicate_trace_step(because(13,rule_desc('remote exploit of a server program',1.0),execCode('10.0.13.37',lea),[netAccess('10.0.13.37',tcp,22),networkServiceInfo('10.0.13.37',openssh,tcp,22,lea),vulExists('10.0.13.37','CVE-2013-48795',openssh,remoteExploit,privEscalation)])).

